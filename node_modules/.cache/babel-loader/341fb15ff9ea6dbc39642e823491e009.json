{"ast":null,"code":"var _jsxFileName = \"/Users/windsor/FYP_Front_end/src/components/Camera.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport io from 'socket.io-client';\nimport Field from './Field';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Camera(props) {\n  _s();\n\n  const Logo = function () {\n    const logo = {\n      audi: require(\"../logo/Audi.png\"),\n      benz: require(\"../logo/Benz.png\"),\n      bmw: require(\"../logo/BMW.png\"),\n      honda: require(\"../logo/Honda.png\"),\n      hyundai: require(\"../logo/Hyundai.jpg\"),\n      infiniti: require(\"../logo/Infiniti.png\"),\n      kia: require(\"../logo/Kia.png\"),\n      landRover: require(\"../logo/LandRover.png\"),\n      lexus: require(\"../logo/Lexus.png\"),\n      mini: require(\"../logo/Mini.png\"),\n      mazda: require(\"../logo/Mazda.png\"),\n      mitsubishi: require(\"../logo/Mitsubishi.png\"),\n      nissan: require(\"../logo/Nissan.png\"),\n      porsche: require(\"../logo/Porsche.png\"),\n      subaru: require(\"../logo/Subaru.png\"),\n      suzuki: require(\"../logo/Suzuki.png\"),\n      tesla: require(\"../logo/Tesla.png\"),\n      toyota: require(\"../logo/Toyota.png\"),\n      volkswagen: require(\"../logo/Volkswagen.png\"),\n      volvo: require(\"../logo/Volvo.png\")\n    };\n\n    const getImage = function (name) {\n      let brand = name.toLowerCase();\n      if (brand in logo) return logo[brand];\n      return require(\"../logo/Not_result.png\");\n    };\n\n    return {\n      getImage\n    };\n  };\n\n  const socket_url = 'ws://localhost:4000/';\n  const flask_url = 'http://localhost:4000/';\n  const cameraID = \"test\";\n  const cameraUrl = flask_url + \"getCameraImage?cameraID=\" + cameraID;\n  const [field, setField] = useState([]);\n  const [mainImage, setMainImage] = useState(\"\");\n  const [cropNum, setCropNum] = useState(0);\n  const [updateTime, setUpdateTime] = useState(1);\n  const socket = io(socket_url);\n  socket.on('connect', function () {});\n  socket.on(\"CameraImageUpdated\", arg => {\n    setUpdateTime(arg);\n    console.log(updateTime);\n  });\n  useEffect(() => {\n    getImage();\n  }, []);\n\n  const getImage = () => {\n    fetch(cameraUrl, {\n      method: 'GET',\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      redirect: 'follow'\n    }).then(res => res.json()).then(json => {\n      console.log(json);\n      setCropNum(json.number_of_slots);\n      setMainImage(flask_url + json.main_image_path);\n      const newfield = [];\n\n      for (let i = 0; i < json.number_of_slots; i++) {\n        newfield.push({\n          key: i + 1,\n          name: \"Camera\" + cameraID + \"-slot-\" + (i + 1),\n          image: flask_url + json.sub_image_path[i],\n          des: \"detecting\"\n        });\n      }\n\n      console.log(newfield);\n      setField(newfield);\n    });\n  };\n  /*useEffect(() => {\n      if(mainImage != \"\")\n          CropImage()\n  }, [mainImage])\n  console.log(cropNum,mainImage)\n  const CropImage = () => {\n   \n    return new Promise(async (resolve, reject) => {\n      var formdata = new FormData();\n      let blob = await fetch(mainImage).then(r => r.blob());\n    formdata.append(\"image\",blob);\n     fetch(\"http://localhost:5000/updateCameraImage?cameraID=001\", {\n      method: 'POST',\n      body: formdata,\n      redirect: 'follow'\n  })\n    .then(response => response.text())\n    .then(response => {\n          const json = JSON.parse(response)\n          console.log(json)\n          if (Array.isArray(json) && json.length > 0) {\n            setBrandID(json[0].class)\n          }\n          else{\n            setBrandID(\"\")\n          }\n    })\n    .catch(error => console.log('error', error));\n    })\n  }*/\n  //const [brand, setBrand] = useState(\"\")\n\n  /*useEffect(() => {\n      if(cropNum != 0 && slotImage.length == cropNum)\n          {const newfield = []\n          for(let i = 0; i < cropNum; i++){\n              console.log(slotImage[i])\n              DetectImage(slotImage[i])\n              \n              newfield.push({\n                  key:i+1,\n                  name: \"Camera\" + cameraID + \"-slot-\" + (i+1),\n                  image: slotImage[i],\n                  des:brand,\n                  brand:Logo().getImage(brand)\n              })\n          }\n          setField(newfield)}\n  }, [cropNum, slotImage.length])*/\n\n\n  const fieldElements = field ? field.map(field => /*#__PURE__*/_jsxDEV(Field, {\n    name: field.name,\n    image: field.image,\n    des: field.des,\n    logo: Logo(),\n    url: flask_url\n  }, field.key, false, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 9\n  }, this)) : /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 8\n  }, this); //brand={field.brand} \n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Field, {\n      image: mainImage,\n      name: \"input\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 9\n    }, this), cropNum !== 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"detection_container\",\n      children: fieldElements\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 31\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 150,\n    columnNumber: 9\n  }, this);\n}\n/**/\n\n_s(Camera, \"PCpEZwQU6ixfdsF0TMMjltC8cxs=\");\n\n_c = Camera;\n\nvar _c;\n\n$RefreshReg$(_c, \"Camera\");","map":{"version":3,"sources":["/Users/windsor/FYP_Front_end/src/components/Camera.js"],"names":["React","useEffect","useState","io","Field","Camera","props","Logo","logo","audi","require","benz","bmw","honda","hyundai","infiniti","kia","landRover","lexus","mini","mazda","mitsubishi","nissan","porsche","subaru","suzuki","tesla","toyota","volkswagen","volvo","getImage","name","brand","toLowerCase","socket_url","flask_url","cameraID","cameraUrl","field","setField","mainImage","setMainImage","cropNum","setCropNum","updateTime","setUpdateTime","socket","on","arg","console","log","fetch","method","headers","redirect","then","res","json","number_of_slots","main_image_path","newfield","i","push","key","image","sub_image_path","des","fieldElements","map"],"mappings":"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","sourcesContent":["import React,{ useEffect, useState } from \"react\"\nimport io from 'socket.io-client'\nimport Field from './Field'\n\nexport default function Camera(props) {\n    const Logo = function(){\n        const logo = {\n            audi: require(\"../logo/Audi.png\"),\n            benz: require(\"../logo/Benz.png\"),\n            bmw: require(\"../logo/BMW.png\"),\n            honda: require(\"../logo/Honda.png\"),\n            hyundai: require(\"../logo/Hyundai.jpg\"),\n            infiniti: require(\"../logo/Infiniti.png\"),\n            kia: require(\"../logo/Kia.png\"),\n            landRover: require(\"../logo/LandRover.png\"),\n            lexus: require(\"../logo/Lexus.png\"),\n            mini: require(\"../logo/Mini.png\"),\n            mazda: require(\"../logo/Mazda.png\"),\n            mitsubishi: require(\"../logo/Mitsubishi.png\"),\n            nissan: require(\"../logo/Nissan.png\"),\n            porsche: require(\"../logo/Porsche.png\"),\n            subaru: require(\"../logo/Subaru.png\"),\n            suzuki: require(\"../logo/Suzuki.png\"),\n            tesla: require(\"../logo/Tesla.png\"),\n            toyota: require(\"../logo/Toyota.png\"),\n            volkswagen: require(\"../logo/Volkswagen.png\"),\n            volvo: require(\"../logo/Volvo.png\")\n        };\n        \n        const getImage = function(name){\n            let brand = name.toLowerCase();\n            if(brand in logo)\n                return logo[brand];\n            return require(\"../logo/Not_result.png\");\n        };\n        \n        return {getImage};\n    };\n\n    const socket_url = 'ws://localhost:4000/'\n    const flask_url = 'http://localhost:4000/'\n    const cameraID = \"test\"\n    const cameraUrl = flask_url + \"getCameraImage?cameraID=\"+cameraID\n    const [field, setField] = useState([])\n    const [mainImage, setMainImage] = useState(\"\")\n    const [cropNum, setCropNum] = useState(0)\n\n    const [updateTime, setUpdateTime] = useState(1)\n    const socket = io(socket_url);\n    socket.on('connect', function(){});\n    socket.on(\"CameraImageUpdated\", (arg) => { \n        setUpdateTime(arg); \n        console.log(updateTime);\n    });\n\n    useEffect(() => {\n        getImage();\n    },[])\n\n\n    const getImage = () =>{\n        fetch(cameraUrl,{\n            method: 'GET',\n            headers: { \"Content-Type\": \"application/json\" },\n            redirect: 'follow'\n            })\n                .then(res => res.json())\n                .then((json) => {\n                    console.log(json)\n                    setCropNum(json.number_of_slots);\n\n                    setMainImage(flask_url+json.main_image_path)\n                    const newfield = []\n                    for(let i = 0; i < json.number_of_slots; i++){\n                        newfield.push({\n                            key:i+1,\n                            name: \"Camera\" + cameraID + \"-slot-\" + (i+1),\n                            image:flask_url+json.sub_image_path[i],\n                            des:\"detecting\",\n                        });\n                    }\n                    console.log(newfield)\n                    setField(newfield)\n                })\n    }\n    /*useEffect(() => {\n        if(mainImage != \"\")\n            CropImage()\n    }, [mainImage])\n    console.log(cropNum,mainImage)\n    const CropImage = () => {\n     \n      return new Promise(async (resolve, reject) => {\n        var formdata = new FormData();\n        let blob = await fetch(mainImage).then(r => r.blob());\n      formdata.append(\"image\",blob);\n  \n    fetch(\"http://localhost:5000/updateCameraImage?cameraID=001\", {\n        method: 'POST',\n        body: formdata,\n        redirect: 'follow'\n    })\n      .then(response => response.text())\n      .then(response => {\n            const json = JSON.parse(response)\n            console.log(json)\n            if (Array.isArray(json) && json.length > 0) {\n              setBrandID(json[0].class)\n            }\n            else{\n              setBrandID(\"\")\n            }\n      })\n      .catch(error => console.log('error', error));\n      })\n    }*/\n    //const [brand, setBrand] = useState(\"\")\n    \n    /*useEffect(() => {\n        if(cropNum != 0 && slotImage.length == cropNum)\n            {const newfield = []\n            for(let i = 0; i < cropNum; i++){\n                console.log(slotImage[i])\n                DetectImage(slotImage[i])\n                \n                newfield.push({\n                    key:i+1,\n                    name: \"Camera\" + cameraID + \"-slot-\" + (i+1),\n                    image: slotImage[i],\n                    des:brand,\n                    brand:Logo().getImage(brand)\n                })\n            }\n            setField(newfield)}\n    }, [cropNum, slotImage.length])*/\n\n  \n    const fieldElements = field?field.map(field => (\n        <Field\n            key={field.key}\n            name={field.name}\n            image={field.image}  \n            des={field.des}\n            logo={Logo()}\n            url= {flask_url}\n        />\n    )):<br/>\n          //brand={field.brand} \n    return(\n        <div>\n        <Field image={mainImage} name=\"input\"/>\n            {cropNum !== 0 && <div className=\"detection_container\">\n                {fieldElements}\n            </div>}\n        </div>\n    )\n}\n\n/**/"]},"metadata":{},"sourceType":"module"}